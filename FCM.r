library("e1071")
library(factoextra)
library(cluster)
library(NbClust)


set.seed(123)
caracteristicas4500Completo <- read.csv("D:/Mestrado - UNB/Sistemas Operacionais/caracteristicas21455.csv")

caracteristicas4500=subset(caracteristicas4500Completo, select = -c(Downloads:MD5))

M1 = sweep(caracteristicas4500,1,rowSums(caracteristicas4500),"/")

start.time <- Sys.time()
cm <- cmeans(M1, 9, iter.max = 100, dist = "euclidean", m = 1.5)
end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken

table(cm$cluster)

c1 <- caracteristicas4500Completo[which(cm$cluster == 1),]
c2 <- caracteristicas4500Completo[which(cm$cluster == 2),]
c3 <- caracteristicas4500Completo[which(cm$cluster == 3),]
c4 <- caracteristicas4500Completo[which(cm$cluster == 4),]
c5 <- caracteristicas4500Completo[which(cm$cluster == 5),]
c6 <- caracteristicas4500Completo[which(cm$cluster == 6),]
c7 <- caracteristicas4500Completo[which(cm$cluster == 7),]
c8 <- caracteristicas4500Completo[which(cm$cluster == 8),]
c9 <- caracteristicas4500Completo[which(cm$cluster == 9),]
#c10 <- caracteristicas4500Completo[which(cm$cluster == 10),]

member <- cm$membership[which(cm$cluster == 5),]
write.csv(member, "D:/Mestrado - UNB/Sistemas Operacionais/membership.csv")

write.csv(c1, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c1.csv")
write.csv(c2, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c2.csv")
write.csv(c3, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c3.csv")
write.csv(c4, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c4.csv")
write.csv(c5, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c5.csv")
write.csv(c6, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c6.csv")
write.csv(c7, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c7.csv")
write.csv(c8, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c8.csv")
write.csv(c9, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c9.csv")
write.csv(c10, file = "D:/Mestrado - UNB/Sistemas Operacionais/c-means-c10.csv")




#pr.out =prcomp (M1, center = FALSE, scale =FALSE)
#pc16= pr.out$x[,1:16]

#cm <- cmeans(M1, 5)
set.seed(123)
cm <- cmeans(M1, 6, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes

set.seed(123)
cm <- cmeans(M1, 7, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes

set.seed(123)
cm <- cmeans(M1, 8, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes

set.seed(123)
cm <- cmeans(M1, 9, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")

resultindexes

set.seed(123)
cm <- cmeans(M1, 10, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes

set.seed(123)
cm <- cmeans(M1, 11, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes

set.seed(123)
cm <- cmeans(M1, 12, iter.max = 100, dist = "euclidean", m = 1.5)
table(cm$cluster)

resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes

set.seed(123)
cm <- cmeans(M1, 13, iter.max = 100, dist = "euclidean", m = 1.5)
resultindexes <- fclustIndex(cm,M1, index="partition.coefficient")
resultindexes



View(cm$membership)


#fviz_cluster(list(data = M1, cluster=cm$cluster), frame.type = "norm",frame.level = 0.68)
