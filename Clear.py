
import pandas as pd
import csv
from dpkt.asn1 import NULL
from pandas.core.index import Index
    

lista=[] 
linha=[]
    
with open('/root/workspace/FormataCSV/src/output.csv') as f:
    # todo o arquivo de entrada e colocado em um vetor. A linha um e colcada na posicao lis[0]
    # e assim por diante.
    lis = [x.split(',') for x in f]
  #  print lis;
count=0
acessada=False
numColunas=0;
numLinhas=0;

numAtributos= 153;
contador=0;
# a variavel x recebe cada coluna do csv. Ou seja, a coluna vira uma linha e cada elemento 
# pode ser acessado como x[i]. O objetivo desse tranformacao e facilitar o acesso
for x in zip(*lis):
    
    
        if contador < numAtributos:
        # a varivael y recebe cada elemento de x. Inicialmente, o nome da coluna, depois o elemento na primeira
        # linha e assim sucessivamente.
       # print x;
            for y in x:
            #    print y;
                    
                if count==0:
                    nomeFuncao=y
                  #  print nomeFuncao;
                    count=count+1
                elif int(y)!=0:
                    
                    acessada=True
         
                    
            if acessada==True:
            #    nomeFuncao=nomeFuncao.replace ("\n", "")
                nomeFuncao=nomeFuncao.replace('\r', '')
                nomeFuncao=nomeFuncao.replace('\n', '')
                lista.append(nomeFuncao)
                
              #  print nomeFuncao     
            
        
        if contador >= numAtributos:
            for z in x:
            #    print y;
                    
                if count==0:
                    z=z.replace('\r', '')
                    z=z.replace('\n', '')
                    lista.append(z)
                    count=count+1
        
        
        contador= contador + 1;
        count=0   
        acessada=False
#str.replace("\n", "")
# realiza a leitura do arquivo de entrada

 
df = pd.read_csv("output.csv")



# lista.append()
# lista.append('Rotulo')
# lista.append('Tipo')
# lista.append('Chamadas')
# lista.append('MD5')




print lista
# mantem no arquivo de entrada apenas as colunas em lista
new_df=df[lista]
numLinhas= new_df.shape[0];
numColunas= new_df.shape[1];

#print numLinhas;
#print numColunas;


acessada=False
for x in range(0, numLinhas): 
    for y in range(0, numColunas):
          
        try:
    
            if  new_df.iloc[x][y] != 0:
             
                acessada=True;
            
        except Exception:
            pass
            
    if acessada == True:
        linha.append(x);
           
    acessada=False
df = new_df.ix[linha]
print df


df.to_csv("caracteristicas.csv", header=True, sep=',', enconding=None, line_terminator='\n', index=False)